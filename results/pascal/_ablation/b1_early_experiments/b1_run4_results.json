{
  "config": {
    "data": {
      "dataset": "pascal_context",
      "dataset_fraction": 1.0,
      "root_dir": "./data/pascal_context"
    },
    "general": {
      "description": "Pascal B1: Task discovery with pure gradient + backbone-only + weighted",
      "seed": 42,
      "title": "pascal_b1_pure_grad_weighted"
    },
    "model": {
      "backbone": "resnet50",
      "num_human_parts_classes": 6,
      "num_seg_classes": 59,
      "out_size": [
        288,
        384
      ],
      "pretrained": true
    },
    "output": {
      "checkpoint_frequency": 5,
      "log_frequency": 1,
      "output_dir": "results/pascal_context/run4",
      "save_checkpoints": true,
      "save_metrics_every_round": true
    },
    "setup": {
      "aggregate_heads": false,
      "aggregation_method": "weighted",
      "alpha": 0.0,
      "n_neighbors": 3,
      "num_clients": 6,
      "task_threshold": 0.1,
      "task_weights_per_client": [
        {
          "edge": 0.0,
          "human_parts": 0.0,
          "segmentation": 1.0
        },
        {
          "edge": 0.0,
          "human_parts": 0.0,
          "segmentation": 1.0
        },
        {
          "edge": 0.0,
          "human_parts": 1.0,
          "segmentation": 0.0
        },
        {
          "edge": 0.0,
          "human_parts": 1.0,
          "segmentation": 0.0
        },
        {
          "edge": 1.0,
          "human_parts": 0.0,
          "segmentation": 0.0
        },
        {
          "edge": 1.0,
          "human_parts": 0.0,
          "segmentation": 0.0
        }
      ]
    },
    "training": {
      "batch_size": 8,
      "early_stopping": {
        "enabled": true,
        "min_delta": 0.005,
        "mode": "min",
        "patience": 6,
        "restore_best_weights": true,
        "verbose": true
      },
      "gradient_clip_norm": 1.0,
      "learning_rate": 0.001,
      "local_epochs": 5,
      "lr_scheduler": {
        "enabled": true,
        "min_lr": 0.0001,
        "type": "cosine",
        "warmup_rounds": 3
      },
      "num_rounds": 50,
      "optimizer": "adam"
    }
  },
  "results": [
    {
      "round": 1,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 2.0508839758959683,
            "segmentation": 2.0508839758959683,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.573526750911366,
            "segmentation": 1.573526750911366,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.030303261496804,
            "segmentation": 0.0,
            "human_parts": 1.030303261496804,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.128441339189356,
            "segmentation": 0.0,
            "human_parts": 1.128441339189356,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931489164179022,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931489164179022
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.1949085710626661,
      "avg_edge_loss": 0.23104934981375033,
      "avg_human_parts_loss": 0.35979076678102667,
      "avg_segmentation_loss": 0.604068454467889
    },
    {
      "round": 2,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.8200676332820545,
            "segmentation": 1.8200676332820545,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.5857379978353328,
            "segmentation": 1.5857379978353328,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.9932039921933954,
            "segmentation": 0.0,
            "human_parts": 0.9932039921933954,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.0749615593390032,
            "segmentation": 0.0,
            "human_parts": 1.0749615593390032,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6933600577441129,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6933600577441129
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.1434130704764163,
      "avg_edge_loss": 0.2310845400347854,
      "avg_human_parts_loss": 0.3446942585887331,
      "avg_segmentation_loss": 0.5676342718528978
    },
    {
      "round": 3,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.7628739422017878,
            "segmentation": 1.7628739422017878,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.7562701810490002,
            "segmentation": 1.7562701810490002,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.023913394321095,
            "segmentation": 0.0,
            "human_parts": 1.023913394321095,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.0706083395264365,
            "segmentation": 0.0,
            "human_parts": 1.0706083395264365,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 187640.49147727274,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 187640.49147727274
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.9738806811246006,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 1.9738806811246006
          }
        }
      ],
      "avg_total_loss": 31274.679837301825,
      "avg_edge_loss": 31273.74422632564,
      "avg_human_parts_loss": 0.34908695564125525,
      "avg_segmentation_loss": 0.586524020541798
    },
    {
      "round": 4,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.8002746105194092,
            "segmentation": 1.8002746105194092,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 2.7841433828527276,
            "segmentation": 2.7841433828527276,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.0232602086934177,
            "segmentation": 0.0,
            "human_parts": 1.0232602086934177,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.2968661026521162,
            "segmentation": 0.0,
            "human_parts": 1.2968661026521162,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.3818064449411451,
      "avg_edge_loss": 0.2310490608215332,
      "avg_human_parts_loss": 0.386687718557589,
      "avg_segmentation_loss": 0.7640696655620228
    },
    {
      "round": 5,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 2.388849876143716,
            "segmentation": 2.388849876143716,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 2.254315571351485,
            "segmentation": 2.254315571351485,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.2361119281161914,
            "segmentation": 0.0,
            "human_parts": 1.2361119281161914,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.3366518237374045,
            "segmentation": 0.0,
            "human_parts": 1.3366518237374045,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.433703927379666,
      "avg_edge_loss": 0.2310490608215332,
      "avg_human_parts_loss": 0.428793958642266,
      "avg_segmentation_loss": 0.7738609079158668
    },
    {
      "round": 6,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.7347574125636707,
            "segmentation": 1.7347574125636707,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 2185.4017333984375,
            "segmentation": 2185.4017333984375,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.2370284308086743,
            "segmentation": 0.0,
            "human_parts": 1.2370284308086743,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.072422444820404,
            "segmentation": 0.0,
            "human_parts": 1.072422444820404,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 365.13870600859326,
      "avg_edge_loss": 0.2310490608215332,
      "avg_human_parts_loss": 0.3849084792715131,
      "avg_segmentation_loss": 364.5227484685002
    },
    {
      "round": 7,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 2.1945607228712602,
            "segmentation": 2.1945607228712602,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 2.1027360395951704,
            "segmentation": 2.1027360395951704,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.3229388432069258,
            "segmentation": 0.0,
            "human_parts": 1.3229388432069258,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.2389112873510881,
            "segmentation": 0.0,
            "human_parts": 1.2389112873510881,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.3742402096589406,
      "avg_edge_loss": 0.2310490608215332,
      "avg_human_parts_loss": 0.426975021759669,
      "avg_segmentation_loss": 0.7162161270777384
    },
    {
      "round": 8,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.786580204963684,
            "segmentation": 1.786580204963684,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.970704891464927,
            "segmentation": 1.970704891464927,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.0529397292570635,
            "segmentation": 0.0,
            "human_parts": 1.0529397292570635,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.4340335130691528,
            "segmentation": 0.0,
            "human_parts": 1.4340335130691528,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.2717587839473377,
      "avg_edge_loss": 0.2310490608215332,
      "avg_human_parts_loss": 0.4144955403877027,
      "avg_segmentation_loss": 0.6262141827381019
    }
  ]
}