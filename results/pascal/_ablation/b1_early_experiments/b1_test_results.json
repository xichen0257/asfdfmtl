{
  "config": {
    "data": {
      "dataset": "pascal_context",
      "dataset_fraction": 1.0,
      "root_dir": "./data/pascal_context"
    },
    "general": {
      "description": "Pascal B1: Task discovery with pure gradient + backbone-only + weighted",
      "seed": 42,
      "title": "pascal_b1_pure_grad_weighted"
    },
    "model": {
      "backbone": "resnet50",
      "num_human_parts_classes": 6,
      "num_seg_classes": 59,
      "out_size": [
        288,
        384
      ],
      "pretrained": true
    },
    "output": {
      "checkpoint_frequency": 5,
      "log_frequency": 1,
      "output_dir": "./results/pascal_context/b1_test",
      "save_checkpoints": true,
      "save_metrics_every_round": true
    },
    "setup": {
      "aggregate_heads": false,
      "aggregation_method": "weighted",
      "alpha": 0.0,
      "n_neighbors": 3,
      "num_clients": 6,
      "task_threshold": 0.1,
      "task_weights_per_client": [
        {
          "edge": 0.0,
          "human_parts": 0.0,
          "segmentation": 1.0
        },
        {
          "edge": 0.0,
          "human_parts": 0.0,
          "segmentation": 1.0
        },
        {
          "edge": 0.0,
          "human_parts": 1.0,
          "segmentation": 0.0
        },
        {
          "edge": 0.0,
          "human_parts": 1.0,
          "segmentation": 0.0
        },
        {
          "edge": 1.0,
          "human_parts": 0.0,
          "segmentation": 0.0
        },
        {
          "edge": 1.0,
          "human_parts": 0.0,
          "segmentation": 0.0
        }
      ]
    },
    "training": {
      "batch_size": 8,
      "early_stopping": {
        "enabled": true,
        "min_delta": 0.005,
        "mode": "min",
        "patience": 6,
        "restore_best_weights": true,
        "verbose": true
      },
      "gradient_clip_norm": 1.0,
      "learning_rate": 0.001,
      "local_epochs": 5,
      "lr_scheduler": {
        "enabled": true,
        "min_lr": 0.0001,
        "type": "cosine",
        "warmup_rounds": 3
      },
      "num_rounds": 2,
      "optimizer": "adam"
    }
  },
  "results": [
    {
      "round": 1,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.740418791770935,
            "segmentation": 1.740418791770935,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.5239849849180742,
            "segmentation": 1.5239849849180742,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.0662779862230474,
            "segmentation": 0.0,
            "human_parts": 1.0662779862230474,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.093197692524303,
            "segmentation": 0.0,
            "human_parts": 1.093197692524303,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.1350289700609264,
      "avg_edge_loss": 0.2310490608215332,
      "avg_human_parts_loss": 0.3599126131245584,
      "avg_segmentation_loss": 0.5440672961148348
    },
    {
      "round": 2,
      "clients": [
        {
          "client_id": 0,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.8202714811671863,
            "segmentation": 1.8202714811671863,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 1,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 0.0,
            "segmentation": 1.0
          },
          "eval_results": {
            "total_loss": 1.6650838201696223,
            "segmentation": 1.6650838201696223,
            "human_parts": 0.0,
            "edge": 0.0
          }
        },
        {
          "client_id": 2,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.9944615093144503,
            "segmentation": 0.0,
            "human_parts": 0.9944615093144503,
            "edge": 0.0
          }
        },
        {
          "client_id": 3,
          "task_weights": {
            "edge": 0.0,
            "human_parts": 1.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 1.090604614127766,
            "segmentation": 0.0,
            "human_parts": 1.090604614127766,
            "edge": 0.0
          }
        },
        {
          "client_id": 4,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        },
        {
          "client_id": 5,
          "task_weights": {
            "edge": 1.0,
            "human_parts": 0.0,
            "segmentation": 0.0
          },
          "eval_results": {
            "total_loss": 0.6931471824645996,
            "segmentation": 0.0,
            "human_parts": 0.0,
            "edge": 0.6931471824645996
          }
        }
      ],
      "avg_total_loss": 1.1594526316180374,
      "avg_edge_loss": 0.2310490608215332,
      "avg_human_parts_loss": 0.3475110205737027,
      "avg_segmentation_loss": 0.5808925502228014
    }
  ]
}